export default class App {
    constructor() {
        this.el = document.querySelector('body')

        this.getElems()
        this.events()
    }

    getElems() {
        this.$pdfContainer = this.el.querySelector('.pdf__container')
        this.$france = this.$pdfContainer.querySelector('.pdf__container-right__top-left')
        this.$foreign = this.$pdfContainer.querySelector('.pdf__container-right__top-right')
        this.$entitled = this.$pdfContainer.querySelector('.pdf__container-right__entitled')
        this.$text = this.$pdfContainer.querySelector('.pdf__container-right__need-text')
        this.$price = this.$pdfContainer.querySelector('.pdf__container-right__button div p')
        this.$priceBox = this.$pdfContainer.querySelector('.pdf__container-right__button div')
        this.$user = this.el.querySelector('.header__user button')
        this.$modal = this.el.querySelector('.modal')
        this.$modalContainer = this.$modal.querySelector('.modal__container')
        this.$modalClose = this.$modal.querySelector('.modal__container-close')
    }

    events() {
        this.$france && this.$france.addEventListener('click', () => {
            this.franceChange()
        })

        this.$foreign && this.$foreign.addEventListener('click', () => {
            this.foreignChange()
        })

        this.$user && this.$user.addEventListener('click', () => {
            this.openModal()
        })

        this.$modalClose && this.$modalClose.addEventListener('click', () => {
            this.closeModal()
        })
    }

    franceChange() {
        this.$entitled.innerHTML = 'Commander votre vignette Crit\'Air pour un véhicule immatriculé en France.'
        this.$text.innerHTML = 'Vous aurez besoin de votre certificat d\'immatriculation (anciennement carte grise).'

        gsap.set(this.$price, {
            innerHTML: '3,11 € + 0,61 € d\'affranchissement (soit 3,72 € par véhicule)',
            color: '#008169'
        })

        this.$priceBox.style.backgroundColor = '#c0eae237'
        this.$pdfContainer.style.backgroundColor = '#c0eae2'

        gsap.set(this.$foreign, {
            borderBottom: '0.1rem solid #9c9c9c',
            backgroundColor: '#f0f0f0'
        })

        gsap.set(this.$france, {
            borderBottom: 'none',
            backgroundColor: '#ffffff'
        })
    }

    foreignChange() {
        this.$entitled.innerHTML = 'Commander votre vignette Crit\'Air pour un véhicule immatriculé à l\'étranger.'
        this.$text.innerHTML = 'Vous aurez besoin d\'une photo lisible ou d\'un scan de votre certificat d\'immatriculation.'

        gsap.set(this.$price, {
            innerHTML: '3,11 € + 1,50 € d\'affranchissement hors France (soit 4,61 € par véhicule)',
            color: '#383838'
        })

        this.$priceBox.style.backgroundColor = '#fff3cf'
        this.$pdfContainer.style.backgroundColor = '#ffe7a0'

        gsap.set(this.$france, {
            borderBottom: '0.1rem solid #9c9c9c',
            backgroundColor: '#f0f0f0'
        })

        gsap.set(this.$foreign, {
            borderBottom: 'none',
            backgroundColor: '#ffffff'
        })
    }

    openModal() {
        this.tlOpenModal = gsap.timeline({
            paused: true,
            defaults: {
                ease: 'Sine.easeInOut'
            }
        })

        this.tlOpenModal
            .to(this.el, {
                overflow: 'hidden',
                duration: 0
            })
        this.tlOpenModal
            .to(this.$modal, {
                display: 'flex',
                height: '100vh',
                duration: 0.5
            })
        this.tlOpenModal
            .fromTo(this.$modalContainer, {
                y: -50,
                opacity: 0,
            }, {
                y: 0,
                opacity: 1,
                duration: 0.5
            })

        this.tlOpenModal.play()
    }

    closeModal() {
        this.tlCloseModal = gsap.timeline({
            paused: true,
            defaults: {
                ease: 'Sine.easeInOut'
            }
        })

        this.tlCloseModal
            .fromTo(this.$modalContainer, {
                y: 0,
                opacity: 1,
            }, {
                y: -50,
                opacity: 0,
                duration: 0.5
            })
        this.tlCloseModal
            .to(this.$modal, {
                display: 'none',
                height: '0vh',
                duration: 0.5
            })
        this.tlCloseModal
            .to(this.el, {
                overflow: 'auto',
                duration: 0
            })

        this.tlCloseModal.play()
    }
}
